// --- ⬇️ 第2步：再次把你的钥匙粘贴到这里 ⬇️ ---
const SUPABASE_URL = ' https://bevnggoqlqgrzemcbuar.supabase.co ';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJldm5nZ29xbHFncnplbWNidWFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MDk3NzIsImV4cCI6MjA4MDQ4NTc3Mn0.kDICGh7Gb4nhYZNiLjzXBquf1mCzT3tk8jfVk0ZKgPg';
// --- ⬆️ 第2步：再次把你的钥匙粘贴到这里 ⬆️ ---

const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
const loginForm=document.getElementById("login-form"),adminPanel=document.getElementById("admin-panel"),userEmailSpan=document.getElementById("user-email"),resourceList=document.getElementById("resource-list");function checkUserSession(e){e?(loginForm.classList.add("hidden"),adminPanel.classList.remove("hidden"),userEmailSpan.textContent=e.user.email,loadResources()):(loginForm.classList.remove("hidden"),adminPanel.classList.add("hidden"))}async function loadResources(){const{data:e,error:t}=await supabase.from("resources").select("*").order("created_at",{ascending:!1});if(t)return;resourceList.innerHTML="",e.forEach(e=>{const t=document.createElement("li");t.innerHTML=`<span>${e.name} (${e.category})</span>`;const n=document.createElement("button");n.textContent="删除",n.onclick=async()=>{confirm(`确定要删除 "${e.name}" 吗？`)&&(await supabase.from("resources").delete().eq("id",e.id),loadResources())},t.appendChild(n),resourceList.appendChild(t)})}document.getElementById("login-button").addEventListener("click",async()=>{const{data:e,error:t}=await supabase.auth.signInWithPassword({email:document.getElementById("email").value,password:document.getElementById("password").value});t?alert("登录失败: "+t.message):checkUserSession(e.session)}),document.getElementById("logout-button").addEventListener("click",async()=>{await supabase.auth.signOut(),loginForm.classList.remove("hidden"),adminPanel.classList.add("hidden")}),document.getElementById("add-button").addEventListener("click",async()=>{const e=document.getElementById("newName").value.trim(),t=document.getElementById("newUrl").value.trim();if(!e||!t)return alert("名称和链接不能为空！");const{error:n}=await supabase.from("resources").insert([{name:e,description:document.getElementById("newDesc").value.trim(),category:document.getElementById("newCategory").value.trim(),url:t}]);n?alert("添加失败: "+n.message):(document.getElementById("newName").value="",document.getElementById("newDesc").value="",document.getElementById("newCategory").value="",document.getElementById("newUrl").value="",loadResources())}),supabase.auth.getSession().then(({data:{session:e}})=>{checkUserSession(e)}),supabase.auth.onAuthStateChange((e,t)=>{checkUserSession(t)});
