// --- ⬇️ 第1步：把你的钥匙粘贴到这里 ⬇️ ---
const SUPABASE_URL = ' https://bevnggoqlqgrzemcbuar.supabase.co ';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJldm5nZ29xbHFncnplbWNidWFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MDk3NzIsImV4cCI6MjA4MDQ4NTc3Mn0.kDICGh7Gb4nhYZNiLjzXBquf1mCzT3tk8jfVk0ZKgPg';
// --- ⬆️ 第1步：把你的钥匙粘贴到这里 ⬆️ ---

const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
document.addEventListener('DOMContentLoaded',()=>{const t=document.getElementById("resource-table-body"),e=document.getElementById("searchInput"),n=document.getElementById("categoryFilter");async function a(){const l=e.value.toLowerCase(),c=n.value;let d=supabase.from("resources").select("*").order("created_at",{ascending:!1});l&&(d=d.or(`name.ilike.%${l}%,description.ilike.%${l}%`)),"all"!==c&&(d=d.eq("category",c));const{data:s,error:o}=await d;o?t.innerHTML=`<tr><td colspan="4" style="text-align:center;color:red;">数据加载失败: ${o.message}</td></tr>`:function(a){t.innerHTML="",0===a.length?t.innerHTML='<tr><td colspan="4" style="text-align:center;">没有找到匹配的资源。</td></tr>':a.forEach(e=>{const n=`<tr><td>${e.name}</td><td>${e.description}</td><td>${e.category}</td><td><a href="${e.url}" target="_blank" rel="noopener noreferrer">点击下载</a></td></tr>`;t.innerHTML+=n})}(s)}e.addEventListener("input",a),n.addEventListener("change",a),async function(){await a(),async function(){const t=await supabase.from("resources").select("category");if(t.error)return;const e=["all",...new Set(t.data.map(t=>t.category).filter(Boolean))];n.innerHTML="",e.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent="all"===t?"全部分类":t,n.appendChild(e)})}()}()});
